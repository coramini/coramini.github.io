---
layout: post
title: "了解高斯混合模型"
date: 2023-07-18
author: Cola Liu
categories: [数学篇]
usemathjax: true
---

## 写在前面
本文主要介绍 **高斯混合模型 GMM（Gaussian Mixure Model）**。

说到高斯混合模型，先来看看高斯模型～

## 高斯模型

**高斯模型（Gaussian Model）** 是统计学中最常用的模型之一，也被称为**正态分布**。

一个常见的例子是身高的分布。在许多人群中，人们的身高通常呈现出接近高斯分布的特征。即在均值附近的人数是最多的，两端人数最少。

我们可以计算身高值的**概率密度**，并将这些值绘制成曲线图。这个曲线图就是高斯分布的形状，通常呈现为**钟形曲线**，峰值位于均值处。

<img src="/assets/imgs/ai/GMM/gaussian.png" width="400" />


## 概率密度函数
**概率密度函数（Probability Density Function，PDF）** 是用来描述连续随机变量的概率分布的函数。它表示了随机变量在某个取值处的概率密度。 我们用一个表达式来表示如下 ⬇️

$$ G(X \|\mu,\sigma) = \frac{1}{\sigma \sqrt{2\pi}}e^{-\frac{\left ( x-\mu \right )^{^{2}}}{2\sigma^{2}}} $$

其中， μ 是自变量X的均值， σ² 为方差。

> 整个概率空间中的概率密度的累积积分等于1，即 ∫f(x)dx = 1，其中积分是在整个取值范围上进行的。

## 多维高斯分布
上面举例为二维高斯分布，在多维空间中，高斯分布概率密度函数跟上述有些许区别：

$$ G(X \|\mu, \Sigma) = \frac{1}{ \sqrt{(2\pi) \|\boldsymbol\Sigma \|} } e^{\left(-\frac{1}{2}({X}-{\mu})^T{\boldsymbol\Sigma}^{-1}({X}-{\mu}) \right)} $$

其中， μ 是自变量X的均值， $\Sigma$ 为协方差矩阵。

## 高斯混合模型
顾名思义，高斯混合模型就是多个高斯模型混合在一起。
我们可以用一张图来直观看一下：

<img src="/assets/imgs/ai/GMM/GMM.png" width="400" />

既然有多个高斯分布，那么就有多个均值μ（μ1，μ2，μ3）和标准差σ（σ1，σ2，σ3），以描述不同的高斯分布模型。

如果具象到具体点的分布，下图中是由两个高斯模型混合而来的例子。
<img src="/assets/imgs/ai/GMM/GMM-2.png" />


从点的分布来看，很像我们之前看到过的聚类 `K-mean` 等。高斯混合模型不仅可以应用于聚类分析，也可以用于密度估计和图像分析等场景。

假设，我们有`k`个高斯分布混合的模型 $p(X \|\mu, \Sigma, \pi)$，那么高斯混合模型公式可以表示为以下的式子 ⬇️
$$ p(X) =\sum_{k=1}^K \pi_k G(X \|\mu_k, \Sigma_k) $$

其中，$ \mu_k $ 为均值，$ \Sigma_k $为协方差矩阵，$\pi_k $为每个高斯分布所占的权重（点的总数有多有少）。


## 模型求解
假设数据是由若干个高斯分布组合而成的，每个高斯分布都由均值、方差和权重所定义。

那么我们可以用`最大似然算法`或者`EM算法`来求出高斯混合模型中的参数，如均值、方差和权重等。

由于算法比较复杂，另外介绍，在此略过。

## 不同参数下的GMM求解
在进行GMM求解时，我们可以设定不同的原始模式，使得数据训练结果不同。

例如，我们对协方差矩阵进行约定，包括`spherical`、`diag`、`tied`、`full`等设置，就可以得到不同的高斯分布模型。

<img src="/assets/imgs/ai/GMM/GMM-diff.png" />

-  `spherical`：是一种描述协方差矩阵的设置。当我们说一个高斯混合模型是"Spherical"时，意味着每个混合成分（高斯分布）具有相同的、对角的协方差矩阵，并且该协方差矩阵是一个标量值的倍数。

- `diagonal`：对角是另一种描述协方差矩阵的术语。当我们说一个高斯混合模型的协方差矩阵是"diagonal"时，意味着每个混合成分（高斯分布）的协方差矩阵是对角矩阵。
- `tied`：高斯混合模型的协方差矩阵是"tied"时，意味着所有混合成分（高斯分布）共享相同的协方差矩阵。那么得出来的高斯分布的曲线形状是相同的，只是均值不同位置不同
- `full`：是指每个混合成分（高斯分布）具有一个完整的协方差矩阵。


## 参考资料
https://scikit-learn.org/stable/modules/mixture.html